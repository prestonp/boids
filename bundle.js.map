{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap 53fc9c6e1d53b2e1d840","webpack:///./main.js","webpack:///./config.js","webpack:///./lib/vector.js","webpack:///./lib/boid.js","webpack:///./lib/gfx.js","webpack:///./lib/hud.js","webpack:///./lib/simulator.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","loop","delta","Date","now","lastCalledTime","fps","setTimeout","window","requestAnimationFrame","config","delay","subset","boids","slice","numBoids","Gfx","clear","drawBoids","drawFps","simulator","moveBoids","Simulator","innerWidth","innerHeight","initBoids","onResize","width","height","maxBoids","maxVel","neighborRadius","reboundVel","headingFactor","repelDistance","cohesion","operator","op","_len","arguments","length","args","Array","_key","x","this","y","isArray","reduce","total","vector","Vector","scalar","val","prototype","add","sub","mul","div","mag","Math","sqrt","unit","scale","Boid","pos","vel","canvas","document","getElementById","ctx","getContext","clearRect","forEach","boid","idx","_boid$pos","fillStyle","fillRect","boidCenter","heading","beginPath","moveTo","lineTo","closePath","stroke","font","fillText","round","callback","addEventListener","e","gui","dat","GUI","rule1","center","b","i","n","rule2","diff","rule3","randPos","random","push","limitVel","limit","boundPos","_this","neighbors","filter","v1","v2","v3"],"mappings":"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","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar config = __webpack_require__(1);\n\tvar Simulator = __webpack_require__(6);\n\tvar Gfx = __webpack_require__(4);\n\tvar simulator = new Simulator(window.innerWidth, window.innerHeight);\n\t__webpack_require__(5);\n\t\n\tvar boids = simulator.initBoids();\n\tvar lastCalledTime = Date.now();\n\tvar fps = 0;\n\t\n\tGfx.onResize(function (width, height) {\n\t  simulator.width = width;\n\t  simulator.height = height;\n\t});\n\t\n\tfunction loop() {\n\t  var delta = (Date.now() - lastCalledTime) / 1000;\n\t  lastCalledTime = Date.now();\n\t  fps = 1 / delta;\n\t\n\t  setTimeout(function () {\n\t    window.requestAnimationFrame(loop);\n\t  }, config.delay);\n\t\n\t  var subset = boids.slice(0, config.numBoids);\n\t\n\t  Gfx.clear();\n\t  Gfx.drawBoids(subset);\n\t  Gfx.drawFps(fps);\n\t  simulator.moveBoids(subset);\n\t}\n\t\n\tloop();\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tmodule.exports = {\n\t  maxBoids: 200,\n\t  numBoids: 100,\n\t  maxVel: 10,\n\t  neighborRadius: 50,\n\t  reboundVel: 10,\n\t  headingFactor: 8, // lower the more uniform\n\t  repelDistance: 10,\n\t  cohesion: 1, // percent of attraction to cluster centers\n\t  delay: 0\n\t};\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar Vector = function Vector(x, y) {\n\t  this.x = x;\n\t  this.y = y;\n\t};\n\t\n\tfunction operator(op) {\n\t  return function () {\n\t    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t      args[_key] = arguments[_key];\n\t    }\n\t\n\t    var x = this.x;\n\t    var y = this.y;\n\t\n\t\n\t    if (Array.isArray(args[0])) args = args[0];\n\t\n\t    return args.reduce(function (total, vector) {\n\t      if (op === '+') {\n\t        total.x += vector.x;\n\t        total.y += vector.y;\n\t      } else if (op === '-') {\n\t        total.x -= vector.x;\n\t        total.y -= vector.y;\n\t      }\n\t      return total;\n\t    }, new Vector(x, y));\n\t  };\n\t}\n\t\n\tfunction scalar(op) {\n\t  return function (val) {\n\t    if (op === '*') {\n\t      return new Vector(this.x * val, this.y * val);\n\t    } else if (op === '/') {\n\t      if (val === 0) val = 1;\n\t      return new Vector(this.x / val, this.y / val);\n\t    }\n\t  };\n\t}\n\t\n\tVector.prototype.add = operator('+');\n\tVector.prototype.sub = operator('-');\n\tVector.prototype.mul = scalar('*');\n\tVector.prototype.div = scalar('/');\n\t\n\tVector.prototype.mag = function () {\n\t  return Math.sqrt(this.x * this.x + this.y * this.y);\n\t};\n\t\n\tVector.prototype.unit = function (scale) {\n\t  if (scale) return this.div(this.mag()).mul(scale);\n\t  return this.div(this.mag());\n\t};\n\t\n\tmodule.exports = Vector;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar Boid = function Boid(pos, vel) {\n\t  this.pos = pos;\n\t  this.vel = vel;\n\t};\n\t\n\tmodule.exports = Boid;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar canvas = document.getElementById('boids');\n\tvar ctx = canvas.getContext('2d');\n\tvar Vector = __webpack_require__(2);\n\t\n\tcanvas.width = window.innerWidth;\n\tcanvas.height = window.innerHeight;\n\t\n\tvar width = 5;\n\tvar height = 5;\n\t\n\tvar Gfx = {\n\t  clear: function clear() {\n\t    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\t  },\n\t\n\t  drawBoids: function drawBoids(boids) {\n\t    boids.forEach(function (boid, idx) {\n\t      var _boid$pos = boid.pos;\n\t      var x = _boid$pos.x;\n\t      var y = _boid$pos.y;\n\t\n\t      ctx.fillStyle = \"rgb(200,0,0)\";\n\t      ctx.fillRect(x, y, width, height);\n\t      var boidCenter = boid.pos.add(new Vector(width / 2, height / 2));\n\t      var heading = boidCenter.add(boid.vel.unit(10));\n\t      ctx.beginPath();\n\t      ctx.moveTo(boidCenter.x, boidCenter.y);\n\t      ctx.lineTo(heading.x, heading.y);\n\t      ctx.closePath();\n\t      ctx.stroke();\n\t    });\n\t    return boids;\n\t  },\n\t\n\t  drawFps: function drawFps(fps) {\n\t    ctx.font = \"32px helvetica\";\n\t    ctx.fillText(Math.round(fps) + ' fps', 10, 30);\n\t  },\n\t\n\t  onResize: function onResize(callback) {\n\t    window.addEventListener('resize', function (e) {\n\t      canvas.width = window.innerWidth;\n\t      canvas.height = window.innerHeight;\n\t      callback(window.innerWidth, window.innerHeight);\n\t    });\n\t  }\n\t};\n\t\n\tmodule.exports = Gfx;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar config = __webpack_require__(1);\n\tvar gui = new dat.GUI();\n\t\n\tgui.add(config, 'numBoids', 1, 200);\n\tgui.add(config, 'maxVel', 1, 100);\n\tgui.add(config, 'neighborRadius', 5, 100);\n\tgui.add(config, 'reboundVel');\n\tgui.add(config, 'headingFactor', 1, 20);\n\tgui.add(config, 'repelDistance', 5, 20);\n\tgui.add(config, 'cohesion', 1, 20);\n\tgui.add(config, 'delay');\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar config = __webpack_require__(1);\n\tvar Boid = __webpack_require__(3);\n\tvar Vector = __webpack_require__(2);\n\t\n\tvar Simulator = function Simulator(width, height) {\n\t  this.width = width;\n\t  this.height = height;\n\t};\n\t\n\tSimulator.prototype.rule1 = function (boid, idx, boids) {\n\t  // Calculate perceived center of swarm (excluding current boid)\n\t  var center = boids.reduce(function (total, b, i) {\n\t    if (b !== boid) {\n\t      total = total.add(b.pos);\n\t    }\n\t    return total;\n\t  }, new Vector(0, 0));\n\t\n\t  var n = boids.length - 1;\n\t  return center.div(n).sub(boid.pos).div(100).mul(config.cohesion);\n\t};\n\t\n\tSimulator.prototype.rule2 = function (boid, idx, boids) {\n\t  // Repel boids from each other\n\t  var c = new Vector(0, 0);\n\t\n\t  boids.forEach(function (b, i) {\n\t    if (b !== boid) {\n\t      var diff = b.pos.sub(boid.pos);\n\t      if (diff.mag() < config.repelDistance) c = c.sub(b.pos.sub(boid.pos));\n\t    }\n\t  });\n\t\n\t  return c;\n\t};\n\t\n\tSimulator.prototype.rule3 = function (boid, idx, boids) {\n\t  // Direction of neighboring boids should influence this boid\n\t  var vel = new Vector(0, 0);\n\t\n\t  boids.forEach(function (b, i) {\n\t    if (b !== boid) {\n\t      vel = vel.add(b.vel);\n\t    }\n\t  });\n\t\n\t  vel = vel.div(boids.length - 1);\n\t  return vel.sub(boid.vel).div(config.headingFactor);\n\t};\n\t\n\tSimulator.prototype.randPos = function () {\n\t  var x = Math.random() * this.width;\n\t  var y = Math.random() * this.height;\n\t  return new Vector(x, y);\n\t};\n\t\n\tSimulator.prototype.initBoids = function () {\n\t  var boids = [];\n\t  var center = new Vector(this.width / 2, this.height / 2);\n\t  for (var i = 0; i < config.maxBoids; i++) {\n\t    var pos = this.randPos();\n\t    var vel = center.sub(pos);\n\t    boids.push(new Boid(pos, vel));\n\t  }\n\t  return boids;\n\t};\n\t\n\tSimulator.prototype.limitVel = function (vel, limit) {\n\t  var mag = vel.mag();\n\t\n\t  if (mag > limit) return vel.div(mag).mul(limit);\n\t  return vel;\n\t};\n\t\n\tSimulator.prototype.boundPos = function (boid) {\n\t  var vel = new Vector(boid.vel.x, boid.vel.y);\n\t\n\t  if (boid.pos.x < 0) {\n\t    vel.x = config.reboundVel;\n\t  } else if (boid.pos.x > this.width) {\n\t    vel.x = -config.reboundVel;\n\t  }\n\t\n\t  if (boid.pos.y < 0) {\n\t    vel.y = config.reboundVel;\n\t  } else if (boid.pos.y > this.height) {\n\t    vel.y = -config.reboundVel;\n\t  }\n\t\n\t  return vel;\n\t};\n\t\n\tSimulator.prototype.moveBoids = function (boids) {\n\t  var _this = this;\n\t\n\t  boids = boids.forEach(function (boid, idx) {\n\t    var neighbors = boids.filter(function (b) {\n\t      return b.pos.sub(boid.pos).mag() < config.neighborRadius;\n\t    });\n\t\n\t    var v1 = _this.rule1(boid, idx, neighbors);\n\t    var v2 = _this.rule2(boid, idx, neighbors);\n\t    var v3 = _this.rule3(boid, idx, neighbors);\n\t    boid.vel = boid.vel.add(v1, v2, v3);\n\t    boid.vel = _this.limitVel(boid.vel, config.maxVel);\n\t    boid.vel = _this.boundPos(boid);\n\t    boid.pos = boid.pos.add(boid.vel);\n\t  });\n\t  return boids;\n\t};\n\t\n\tmodule.exports = Simulator;\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** bundle.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 53fc9c6e1d53b2e1d840\n **/","const config = require('./config');\nconst Simulator = require('./lib/simulator');\nconst Gfx = require('./lib/gfx');\nconst simulator = new Simulator(window.innerWidth, window.innerHeight);\nrequire('./lib/hud');\n\nlet boids = simulator.initBoids();\nlet lastCalledTime = Date.now();\nlet fps = 0;\n\nGfx.onResize((width, height) => {\n  simulator.width = width;\n  simulator.height = height;\n});\n\nfunction loop() {\n  const delta = (Date.now() - lastCalledTime) / 1000;\n  lastCalledTime = Date.now();\n  fps = 1/delta;\n\n  setTimeout(() => {\n    window.requestAnimationFrame(loop);\n  }, config.delay);\n\n  const subset = boids.slice(0, config.numBoids);\n\n  Gfx.clear();\n  Gfx.drawBoids(subset);\n  Gfx.drawFps(fps);\n  simulator.moveBoids(subset);\n}\n\nloop();\n\n\n\n/** WEBPACK FOOTER **\n ** ./main.js\n **/","module.exports = {\n  maxBoids: 200,\n  numBoids: 100,\n  maxVel: 10,\n  neighborRadius: 50,\n  reboundVel: 10,\n  headingFactor: 8, // lower the more uniform\n  repelDistance: 10,\n  cohesion: 1, // percent of attraction to cluster centers\n  delay: 0\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./config.js\n **/","const Vector = function(x, y) {\n  this.x = x;\n  this.y = y;\n};\n\nfunction operator(op) {\n  return function(...args) {\n    const { x, y } = this;\n\n    if (Array.isArray(args[0]))\n      args = args[0];\n\n    return args.reduce((total, vector) => {\n      if (op === '+') {\n        total.x += vector.x;\n        total.y += vector.y;\n      } else if (op === '-') {\n        total.x -= vector.x;\n        total.y -= vector.y;\n      }\n      return total;\n    }, new Vector(x, y));\n  };\n}\n\nfunction scalar(op) {\n  return function(val) {\n    if (op === '*') {\n      return new Vector(this.x * val, this.y * val);\n    } else if (op === '/') {\n      if (val === 0) val = 1;\n      return new Vector(this.x / val, this.y / val);\n    }\n  };\n}\n\nVector.prototype.add = operator('+');\nVector.prototype.sub = operator('-');\nVector.prototype.mul = scalar('*');\nVector.prototype.div = scalar('/');\n\nVector.prototype.mag = function() {\n  return Math.sqrt(this.x * this.x + this.y * this.y);\n};\n\nVector.prototype.unit = function(scale) {\n  if (scale) return this.div(this.mag()).mul(scale);\n  return this.div(this.mag());\n};\n\nmodule.exports = Vector;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/vector.js\n **/","var Boid = function(pos, vel) {\n  this.pos = pos;\n  this.vel = vel;\n};\n\nmodule.exports = Boid;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/boid.js\n **/","let canvas = document.getElementById('boids');\nlet ctx = canvas.getContext('2d');\nconst Vector = require('./vector');\n\ncanvas.width  = window.innerWidth;\ncanvas.height = window.innerHeight;\n\nconst width = 5;\nconst height = 5;\n\nconst Gfx = {\n  clear: function() {\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n  },\n\n  drawBoids: function(boids) {\n    boids.forEach((boid, idx) => {\n      const { x, y } = boid.pos;\n      ctx.fillStyle = \"rgb(200,0,0)\";\n      ctx.fillRect(x, y, width, height);\n      const boidCenter = boid.pos.add(new Vector(width/2, height/2));\n      const heading = boidCenter.add(boid.vel.unit(10));\n      ctx.beginPath();\n      ctx.moveTo(boidCenter.x, boidCenter.y);\n      ctx.lineTo(heading.x, heading.y);\n      ctx.closePath();\n      ctx.stroke();\n    });\n    return boids;\n  },\n\n  drawFps: function(fps) {\n    ctx.font = \"32px helvetica\";\n    ctx.fillText(Math.round(fps) + ' fps', 10, 30);\n  },\n\n  onResize: function(callback) {\n    window.addEventListener('resize', (e) => {\n      canvas.width  = window.innerWidth;\n      canvas.height = window.innerHeight;\n      callback(window.innerWidth, window.innerHeight);\n    });\n  }\n};\n\nmodule.exports = Gfx;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/gfx.js\n **/","const config = require('../config');\nconst gui = new dat.GUI();\n\ngui.add(config, 'numBoids', 1, 200);\ngui.add(config, 'maxVel', 1, 100);\ngui.add(config, 'neighborRadius', 5, 100);\ngui.add(config, 'reboundVel');\ngui.add(config, 'headingFactor', 1, 20);\ngui.add(config, 'repelDistance', 5, 20);\ngui.add(config, 'cohesion', 1, 20);\ngui.add(config, 'delay');\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/hud.js\n **/","const config = require('../config');\nconst Boid = require('./boid');\nconst Vector = require('./vector');\n\nconst Simulator = function(width, height) {\n  this.width = width;\n  this.height = height;\n};\n\nSimulator.prototype.rule1 = function(boid, idx, boids) {\n  // Calculate perceived center of swarm (excluding current boid)\n  const center = boids.reduce((total, b, i) => {\n    if (b !== boid) {\n      total = total.add(b.pos);\n    }\n    return total;\n  }, new Vector(0, 0));\n\n  const n = boids.length - 1;\n  return center.div(n).sub(boid.pos).div(100).mul(config.cohesion);\n};\n\nSimulator.prototype.rule2 = function(boid, idx, boids) {\n  // Repel boids from each other\n  let c = new Vector(0, 0);\n\n  boids.forEach((b, i) => {\n    if (b !== boid) {\n      let diff = b.pos.sub(boid.pos);\n      if (diff.mag() < config.repelDistance)\n        c = c.sub(b.pos.sub(boid.pos));\n    }\n  });\n\n  return c;\n};\n\nSimulator.prototype.rule3 = function(boid, idx, boids) {\n  // Direction of neighboring boids should influence this boid\n  let vel = new Vector(0, 0);\n\n  boids.forEach((b, i) => {\n    if (b !== boid) {\n      vel = vel.add(b.vel);\n    }\n  });\n\n  vel = vel.div(boids.length-1);\n  return vel.sub(boid.vel).div(config.headingFactor);\n};\n\nSimulator.prototype.randPos = function() {\n  const x = Math.random() * this.width;\n  const y = Math.random() * this.height;\n  return new Vector(x,y);\n}\n\nSimulator.prototype.initBoids = function() {\n  const boids = [];\n  const center = new Vector(this.width/2, this.height/2);\n  for(let i=0; i<config.maxBoids; i++) {\n    const pos = this.randPos();\n    const vel = center.sub(pos);\n    boids.push(new Boid(pos, vel));\n  }\n  return boids;\n};\n\nSimulator.prototype.limitVel = function(vel, limit) {\n  const mag = vel.mag();\n\n  if (mag > limit)\n    return vel.div(mag).mul(limit);\n  return vel;\n};\n\nSimulator.prototype.boundPos = function(boid) {\n  let vel = new Vector(boid.vel.x, boid.vel.y);\n\n  if (boid.pos.x < 0)  {\n    vel.x = config.reboundVel;\n  } else if (boid.pos.x > this.width) {\n    vel.x = -config.reboundVel;\n  }\n\n  if (boid.pos.y < 0) {\n    vel.y = config.reboundVel;\n  } else if (boid.pos.y > this.height) {\n    vel.y = -config.reboundVel;\n  }\n\n  return vel;\n};\n\nSimulator.prototype.moveBoids = function(boids) {\n  boids = boids.forEach((boid, idx) => {\n    const neighbors = boids.filter((b) => {\n      return b.pos.sub(boid.pos).mag() < config.neighborRadius;\n    });\n\n    let v1 = this.rule1(boid, idx, neighbors);\n    let v2 = this.rule2(boid, idx, neighbors);\n    let v3 = this.rule3(boid, idx, neighbors);\n    boid.vel = boid.vel.add(v1, v2, v3);\n    boid.vel = this.limitVel(boid.vel, config.maxVel);\n    boid.vel = this.boundPos(boid);\n    boid.pos = boid.pos.add(boid.vel);\n  });\n  return boids;\n};\n\nmodule.exports = Simulator;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/simulator.js\n **/"],"sourceRoot":""}